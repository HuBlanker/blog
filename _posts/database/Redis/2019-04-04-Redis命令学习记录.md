---
layout: post
category: [Redis]
tags:
  - Redis
---

## 背景介绍

以下摘自:Redis官网.

> Redis is an open source (BSD licensed), in-memory data structure store, used as a database, cache and message broker. It supports data structures such as strings, hashes, lists, sets, sorted sets with range queries, bitmaps, hyperloglogs, geospatial indexes with radius queries and streams. Redis has built-in replication, Lua scripting, LRU eviction, transactions and different levels of on-disk persistence, and provides high availability via Redis Sentinel and automatic partitioning with Redis Cluster.


总的来说,Redis是一个基于内存的高性能的键值型数据库,也就是常说的NoSQL,可以用来作为数据库或者缓存.并且支持多种数据结构,包括字符串，散列，列表，集合，带有范围查询的排序集，位图，超级日志(直译,具体翻译不确定)，具有半径查询和流的地理空间索引.

各种语言都提供了Redis的客户端,比如Java的`Jedis`和python的`redis-py`.

同时Redis也提供交互式的客户端,在mac上执行:

`brew install redis`进行安装,安装完成后执行:

`redis-cli` 进入交互式的客户端,即可开始使用.

本文主要用来记录针对各种数据结构的操作命令,来源主要是Redis官网加上自己的理解. 由于英语问题,不保证理解一定正确. 大家可以参考[redis官网](https://redis.io)来进行学习.

## public

- **help**: 这个命令很重要,只要你用的好,可以查看所有命令的用法,可以起到一个临时提示的作用,比如这个命令有哪些选项等等. 使用方法: `help`之后根据提示输入:`help command`,即可以查看该命令的详细方法签名.

- **keys**: 使用模式匹配,返回匹配的key,使用`*`进行查看全量的key. 注意:不要在线上使用这个命令,不可控. `keys **`

- **exists**: 查看某个key是否存在,存在返回1,不存在返回0.`exists key`. 

- **scan**: 遍历所有的key,因为做了分页,所以是安全的. `sacn cursor match * count 100`. `*`可以进行模式匹配. `cursor`初次使用为0,之后每一次为上一次`scan`返回的游标.

- **type**:查看某个key的类型,返回描述.`type key`.

- **del**: 删除key,可以删除多个. `del key1 key2`

- **expire**: 设置过期时间, `expire key seconds`.

- **ttl**: 查看key的剩余生存时间, `ttl key`

- **pttl**: 以毫秒形式查看key的过期时间, `pttl key`

- **move**: 将当前数据库中的某个key移到新的数据库. `move key db`

- **dump**: 拿到序列化后的value. `dump key`.

- **resotre**: 用上一个命令拿到的值回复某个key.`resotre key seconds 序列化的value`

## DB

这块其实也是public的一部分,我单独将其写出来一下.

- **select**: 选择数据库,默认为16个数据库可以选择.`select index`

- **flushdb**: 删除当前db的所有key. `flushdb`.

- **swapdb**: 交换两个数据库.`swapdb index1 index2`.

- **randomkey**: 在当前库里随机返回一个key. `randomkey`.

- **monitor**: 监视器,可以监视某个redis接受的所有命令.`redis-cli monitor`. 直接在命令行中执行.

## string

- **set**: 设置某个key的value.`set key value`
- **get**: 获取某个key的value. `get key`
- **strlen**: 返回字符串的长度.`strlen key`
- **append**: 如果key存在并且为字符串,则追加值,如果key不存在,则创建并追加,此时相当于set. 成功后返回追加后字符串的长度.`append key value`
- **getrange**: 根据输入的偏移来返回子字符串.支持-1偏移,代表最后一个字符. `getrange key start end`
- **setrange**: 在key的指定偏移量处写入新的值.`setrange key offset value`
- **incr**: 操作整数.当你的key中存储的是整数的时候,会将整数加1.需要注意的是,key为空的时候会被置为0然后加1.key的值为不能解释为数字的字符串时会报错.`incr key`
- **decr**: `incr`的反操作,递减1.`decr key`
- **incrby**: 递增某个增量.其他同`incr`一样. `incrby key one_int_value`.
- **decrby**: `incrby` 的反操作.递减某个量.`decrby key one_int_value`
- **mget**: 一次性获取多个key.注意如果key不存在会返回`nil`,所以这条命令永远不会出错. `mget key1 key2 ...`
- **mset**: 一次性写入多个key-value. 不会失败,并且是原子操作.也就是说所有值必然会更新. `mset key1 value1 key2 value2`
- **msetnx**: 批量的非空写入,注意是原子操作,所以当某一个key存在,所以key都不会被写入. `msetnx key1 value1 key2 value2`
- **setex**: 设置key=value且过期时间为seconds.原子操作,相当于`set + expire`. 语法`set key seconds value`
- **setnx**: 是`set if not exists`,当key不存在时写入,存在时不做任何操作.`setnx key value`
- **getset**: 设置新值并返回旧值.`getset key new_value`
- **psetex** : 和`setex`相似,区别只是设置的过期时间单位为毫秒.`psetex key ms value`

常用的string相关命令基本都在这里了,剩下一些小对`bit`的操作,暂时没有需要用到的地方,不做学习,等到需要用再添加.


## list

## sets

## sorted sets

## hashes

## streams 

本章节的命令签名较长且变化较多,因此不再提供示例命令和方法签名,可以去下面的链接中学习.

[stream相关命令](https://redis.io/commands#stream)

- **XINFO**: 用于检索有关流和关联的消费者组的不同信息.有三种子命令,STREAMS,GROUPS,CONSUMERS.

- **XADD**: 将给定的条目添加到Stream中,如果stream不存在,则以key创建一个Stream.

- **XRANGE**: 从Stream中查找指定范围的条目并返回.

- **XREVRANGE**: **XRANGE**的倒序版本,接受参数也是倒序.

- **XLEN**: 返回Stream中的项目数量.

- **XDEL**: 从Stream删除给定ID的项目.

- **XREAD**: 从一个或者多个Stream中读取数据,仅返回ID大于传入ID的信息.

- **XTRIM**: 将Stream修剪的只保留给定数量的项目,有多种修剪策略,目前只实现了一种.

- **XREADGROUP**:使用消费者组从Stream中读取信息.

- **XACK**:确认已经处理消息.

- **XCLAIM**: 更改消息的所有权,可以是其他消费者来处理此消息,

- **XPENDING**: 查看正在处理的消息的信息.

- **XGROUP**: 创建,销毁,管理消费者组.也有多个子命令,CREATE,SETID,DESTROY,DELCONSUMER.

## bitmaps

## hyperloglogs

## geospatial index

完。

<br>
<br>
<br>
<br>
<h4>ChangeLog</h4>
2018-04-04 开始连载
<br>
<br>

**以上皆为个人所思所得，如有错误欢迎评论区指正。**

**欢迎转载，烦请署名并保留原文链接。**

**联系邮箱：huyanshi2580@gmail.com**

**更多学习笔记见个人博客------><a href="{{ site.baseurl }}/">呼延十</a>**
